# Searches for all aws_instance resources within the tfplan import.
# Any matching instances are then scanned for the tags attribute.

import "tfplan"

main = rule {
    if tfplan.resources is not null {
        all tfplan.resources.aws_instance as _, instances {
            all instances as _, r {
                (r.applied.tags is not null and length(r.applied.tags) else 0 ) > 0
            }
        }
    }
}
